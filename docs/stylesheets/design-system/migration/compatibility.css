/* ================================================
   Migration Compatibility Layer
   ================================================
   Provides backward compatibility during migration
   ================================================ */

@layer theme {
  :root {
    /* Legacy color aliases */
    --primary-color: var(--primary-600);
    --accent-color: var(--info-500);
    --success-color: var(--success-500);
    --error-color: var(--error-500);
    --warning-color: var(--warning-500);
    
    /* Legacy spacing aliases */
    --spacing-unit: var(--space-1);
    --spacing-xs: var(--space-1);
    --spacing-sm: var(--space-2);
    --spacing-md: var(--space-4);
    --spacing-lg: var(--space-6);
    --spacing-xl: var(--space-8);
    
    /* Legacy component colors */
    --axiom-bg: rgba(var(--primary-500-rgb), 0.05);
    --axiom-border: var(--primary-500);
    --decision-bg: rgba(var(--success-500-rgb), 0.05);
    --decision-border: var(--success-500);
    --failure-bg: rgba(var(--error-500-rgb), 0.05);
    --failure-border: var(--error-500);
    
    /* Legacy shadow values for flat design */
    --shadow-sm: none;
    --shadow-md: none;
    --shadow-lg: none;
  }
}

/* ================================================
   Component Class Mappings
   ================================================ */

/* Map old button classes to new */
.button { @extend .btn; }
.button.primary { @extend .btn-primary; }
.button.secondary { @extend .btn-secondary; }
.button.small { @extend .btn-sm; }
.button.large { @extend .btn-lg; }

/* Map old grid classes to new */
.row { @extend .grid; }
.col { @extend .col-span-1; }
.col-6 { @extend .col-span-6; }
.col-md-6 { @extend .md\:col-span-6; }

/* ================================================
   Deprecation Warnings (Development Only)
   ================================================ */

@media (--development) {
  /* Visual deprecation warnings */
  .button::after,
  .old-grid::after,
  .legacy-component::after {
    content: "⚠️ Deprecated - See migration guide";
    position: absolute;
    top: -20px;
    left: 0;
    background: var(--warning-500);
    color: white;
    font-size: 10px;
    padding: 2px 6px;
    border-radius: var(--radius-sm);
    font-family: var(--font-mono);
    pointer-events: none;
    z-index: 9999;
  }
  
  /* Console warnings via CSS */
  .button {
    --deprecated-warning: "Class .button is deprecated. Use .btn instead.";
  }
}

/* ================================================
   Color Migration Helpers
   ================================================ */

/* Automatically convert hardcoded colors */
[style*="#5448C8"] { --mapped-color: var(--primary-600) !important; }
[style*="#00BCD4"] { --mapped-color: var(--info-500) !important; }
[style*="#4CAF50"] { --mapped-color: var(--success-500) !important; }
[style*="#F44336"] { --mapped-color: var(--error-500) !important; }
[style*="#FF9800"] { --mapped-color: var(--warning-500) !important; }

/* ================================================
   Spacing Migration Helpers
   ================================================ */

/* Common pixel values to token mappings */
.p-10 { padding: var(--space-2) !important; } /* 10px → 8px */
.p-15 { padding: var(--space-3) !important; } /* 15px → 12px */
.p-20 { padding: var(--space-5) !important; } /* 20px → 20px */
.m-10 { margin: var(--space-2) !important; }
.m-15 { margin: var(--space-3) !important; }
.m-20 { margin: var(--space-5) !important; }

/* ================================================
   Feature Flags via CSS
   ================================================ */

/* Control which system is active */
:root {
  --use-new-buttons: true;
  --use-new-forms: true;
  --use-new-grid: true;
  --use-new-typography: true;
}

/* Conditional component display */
[data-feature="new-buttons"]:not([data-enabled="true"]) { display: none; }
[data-feature="old-buttons"][data-enabled="true"] { display: none; }

/* ================================================
   Migration Utilities
   ================================================ */

/* Temporary override classes during migration */
.migration-override {
  /* Use !important sparingly during migration only */
  font-family: var(--font-sans) !important;
  color: var(--text-primary) !important;
  background: var(--surface-primary) !important;
}

/* Visual diff helper for A/B testing */
.migration-diff {
  position: relative;
  
  &::before {
    content: "OLD";
    position: absolute;
    top: -10px;
    left: -10px;
    background: red;
    color: white;
    font-size: 10px;
    padding: 2px 4px;
    font-family: var(--font-mono);
  }
}

.migration-diff-new {
  position: relative;
  
  &::before {
    content: "NEW";
    position: absolute;
    top: -10px;
    left: -10px;
    background: green;
    color: white;
    font-size: 10px;
    padding: 2px 4px;
    font-family: var(--font-mono);
  }
}